var moqui={localeMap:{zh:"zh-cn"},isString:function(a){return"string"===typeof a},isBoolean:function(a){return"boolean"===typeof a},isNumber:function(a){return"number"===typeof a},isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)},isPlainObject:function(a){return null!=a&&"object"==typeof a&&"[object Object]"===Object.prototype.toString.call(a)},deepCopy:function(a){if("object"!==typeof a||
null===a)return a;var c=Array.isArray(a)?[]:{},b,d;for(b in a)d=a[b],c[b]=moqui.deepCopy(d);return c},objToSearch:function(a){var c="";moqui.isPlainObject(a)&&$.each(a,function(a,d){c=c+(0<c.length?"\x26":"")+a+"\x3d"+d});return c},searchToObj:function(a){if(!a||0===a.length)return{};var c={};a=a.split("\x26");for(var b=0;b<a.length;b++){var d=a[b].split("\x3d");if(1<d.length){var e=d[0],d=d[1],f=c[e];f?moqui.isArray(f)?f.push(d):c[e]=[f,d]:c[e]=d}}return c},parseHref:function(a){var c={protocol:"",
host:"",path:"/",query:{},search:"",hash:"",name:""},b=a.indexOf("://");if(0<=b){c.protocol=a.slice(0,b);var d=a.indexOf("/",b+3);if(-1===d)return a.length>b+3&&(c.host=a.slice(b+3)),c;c.host=a.slice(b+3,d);a=a.slice(d)}b=a.split("#");1<b.length&&b[1].length&&(c.hash=b[1],a=b[0]);a=a.split("?");1<a.length&&a[1].length&&(b=a[1],c.search=b,c.query=moqui.searchToObj(b));a=a[0];c.path=a;a.length&&(b=a.lastIndexOf("/"),c.name=-1===b?a:a.slice(b+1));return c},makeHref:function(a){var c="";a.protocol&&a.protocol.length&&
(c+=a.protocol+"://");a.host&&a.host.length&&(c+=a.host);c+=a.path||"/";if(a.search&&a.search.length)c+="?"+a.search;else if(a.query){var b=moqui.objToSearch(a.query);b&&b.length&&(c+="?"+b)}a.hash&&a.hash.length&&(c+="#"+a.hash);return c},htmlEncode:function(a){return $("\x3cdiv/\x3e").text(a).html()},htmlDecode:function(a){return $("\x3cdiv/\x3e").html(a).text()},loadScript:function(a,c,b){var d=null;$("head script").each(function(c,b){-1!==b.src.indexOf(a)&&(d=b)});if(d)c&&(b?moqui.retryValidateCallback(function(){c(null,
d)},b):c(null,d));else{var e=document.createElement("script");e.src=a;e.async=!1;c&&(e.onload=function(){this.onerror=this.onload=null;b?moqui.retryValidateCallback(function(){c(null,e)},b):c(null,e)},e.onerror=function(){this.onerror=this.onload=null;var a=Error("Error loading script "+this.src);console.error(a);c(a,e)});document.head.appendChild(e)}},retryValidateCallback:function(a,c,b){!c||c()?a():(b||(b=1),8>=b&&setTimeout(moqui.retryValidateCallback,b*b*100,a,c,b+1))},loadStylesheet:function(a,
c,b){c||(c="stylesheet");b||(b="text/css");var d=!1;$("head link").each(function(c,b){-1!==b.href.indexOf(a)&&(d=!0)});if(!d){var e=document.createElement("link");e.href=a;e.rel=c;e.type=b;document.head.appendChild(e)}},retryInlineScript:function(a,c){try{eval(a)}catch(d){a=a.trim();var b=5>=c?c*c*100:-1;console.warn("inline script error "+c+" retry "+b+" script: "+a.slice(0,80)+"...");console.warn(d);5>=c&&setTimeout(moqui.retryInlineScript,b,a,c+1)}},decimalSeparator:(1.1).toLocaleString().substring(1,
2),thousandSeparator:(1E3).toLocaleString().substring(1,2),isStringInteger:function(a){if(!moqui.isString(a))return!1;for(var c=0;c<a.length;c++){var b=a[c];if(!("0"<=b&&"9">=b||0===c&&"-"===b||b===moqui.thousandSeparator))return!1}return!0},isStringNumber:function(a){if(!moqui.isString(a))return!1;for(var c=0;c<a.length;c++){var b=a[c];if(!("0"<=b&&"9">=b||0===c&&"-"===b||b===moqui.thousandSeparator||b===moqui.decimalSeparator))return!1}return!0},parseNumber:function(a){a=a.replaceAll(moqui.thousandSeparator,
"");return-1===a.indexOf(moqui.decimalSeparator)?parseInt(a):parseFloat(a)},format:function(a,c,b){c&&c.length&&(c=c.replace(/a/,"A").replace(/d/,"D").replace(/y/,"Y"));if(b&&b.length){b=b.toLowerCase();if("date"===b)return c&&0!==c.length||(c="YYYY-MM-DD"),moment(a).format(c);if("time"===b)return c&&0!==c.length||(c="HH:mm:ss"),moment(a).format(c);if("timestamp"===b)return c&&0!==c.length||(c="YYYY-MM-DD HH:mm"),moment(a).format(c);if("bigdecimal"===b||"currency"===b)return a.toFixed(2).replace(/(\d)(?=(\d{3})+(?!\d))/g,
"$1,");if("long"===b||"integer"===b||"double"===b||"float"===b)return a.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");console.warn("format type unknown: "+b)}if(moqui.isNumber(a))return a.toFixed(2).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");b=moment(a);return b.isValid()?(c&&0!==c.length||(c="YYYY-MM-DD HH:mm"),b.format(c)):a},debounce:function(a,c){var b,d;return function(){var e=this,f=arguments;clearTimeout(b);b=setTimeout(function(){b=null;d=a.apply(e,f)},c);return d}},makeColumnsConsistent:function(a){a=
$("#"+a+" table");var c=[],b,d,e,f;for(b=0;b<a.length;b++)if(d=a[b],d.rows&&0!==d.rows.length){f=0;for(e=d.rows[f];5>f&&f<d.rows.length;)if((!e.cells||1>=e.cells.length)&&d.rows.length>f+1)f++,e=d.rows[f];else break;if(e.cells&&0!==e.cells.length)for(d=0;d<e.cells.length;d++){var g=$(e.cells[d]).width();if(!c[d]||c[d]<g)c[d]=g}}e=c.length;for(b=d=0;b<e;b++)d+=c[b];g=[];for(b=0;b<e;b++)g[b]=100*c[b]/d;for(b=0;b<a.length;b++)if(d=a[b],d.rows&&0!==d.rows.length){f=0;for(e=d.rows[f];5>f&&f<d.rows.length;)if((!e.cells||
1>=e.cells.length)&&d.rows.length>f+1)f++,e=d.rows[f];else break;if(e.cells&&0!==e.cells.length)for(d=0;d<e.cells.length;d++)e.cells[d].style.width=g[d]+"%"}},downloadData:function(a,c,b){a=new Blob([a],{type:b});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,c);else{var d=document.createElement("a"),e=URL.createObjectURL(a);d.href=e;d.download=c;document.body.appendChild(d);d.click();setTimeout(function(){document.body.removeChild(d);window.URL.revokeObjectURL(e)},0)}},
notifyNotification:function(a,c){if(a){var b={};a.topic&&a.topic.length&&(b.tag=a.topic);if(window.Notification&&"granted"===Notification.permission){var d=new Notification(a.title,b);a.link&&a.link.length&&(d.onclick=function(){window.open(a.link)});moqui.webrootVue&&moqui.webrootVue.addNotify(a.title,a.type)}else window.Notification&&"denied"!==Notification.permission?Notification.requestPermission(function(d){"granted"===d?(d=new Notification(a.title,b),a.link&&a.link.length&&(d.onclick=function(){window.open(a.link)}),
moqui.webrootVue&&moqui.webrootVue.addNotify(a.title,a.type)):c(a)}):c(a)}},NotifyOptions:function(a,c,b,d){this.message=moqui.htmlEncode(a);c&&(this.url=c);this.icon=d?d:"success"===b?"fa fa-check-circle":"warning"===b?"fa fa-exclamation-triangle":"danger"===b?"fa fa-exclamation-circle":"fa fa-info-circle"},NotifySettings:function(a){this.delay=4E3;this.offset={x:20,y:60};this.placement={from:"top",align:"right"};this.animate={enter:"animated fadeInDown",exit:""};this.type=a?a:"info";this.template=
'\x3cdiv data-notify\x3d"container" class\x3d"notify-container col-xs-11 col-sm-3 alert alert-{0}" role\x3d"alert"\x3e\x3cbutton type\x3d"button" aria-hidden\x3d"true" class\x3d"close" data-notify\x3d"dismiss"\x3e\x26times;\x3c/button\x3e\x3cspan data-notify\x3d"icon"\x3e\x3c/span\x3e \x3cspan data-notify\x3d"message"\x3e{2}\x3c/span\x3e\x3ca href\x3d"{3}" target\x3d"{4}" data-notify\x3d"url"\x3e\x3c/a\x3e\x3c/div\x3e'},notifyGrowl:function(a){if(a){var c=new moqui.NotifySettings(a.type);!0===a.alertNoAutoHide&&
(c.delay=0);$.notify(new moqui.NotifyOptions(a.title,a.link,a.type,a.icon),c);moqui.webrootVue&&moqui.webrootVue.addNotify(a.title,a.type)}},NotificationClient:function(a){this.displayEnable=!0;this.webSocketUrl=a;this.topicListeners={};this.disableDisplay=function(){this.displayEnable=!1};this.enableDisplay=function(){this.displayEnable=!0};this.initWebSocket=function(){this.webSocket=new WebSocket(this.webSocketUrl);this.webSocket.clientObj=this;this.webSocket.onopen=function(a){this.clientObj.tryReopenCount=
0;a=[];for(var b in this.clientObj.topicListeners)a.push(b);this.send("subscribe:"+a.join(","))};this.webSocket.onmessage=function(a){var b=JSON.parse(a.data);(a=this.clientObj.topicListeners[b.topic])&&a.forEach(function(a){a(b,this)},this);(a=this.clientObj.topicListeners.ALL)&&a.forEach(function(a){a(b,this)},this)};this.webSocket.onclose=function(a){console.log(a);setTimeout(this.clientObj.tryReopen,3E4,this.clientObj)};this.webSocket.onerror=function(a){console.log(a)}};this.tryReopen=function(a){a.webSocket&&
a.webSocket.readyState!==WebSocket.CLOSED&&a.webSocket.readyState!==WebSocket.CLOSING||a.tryReopenCount&&!(6>a.tryReopenCount)||(console.log("Trying WebSocket reopen, count "+a.tryReopenCount),a.tryReopenCount=(a.tryReopenCount||0)+1,a.initWebSocket())};this.displayNotify=function(a,b){b.clientObj.displayEnable&&a.title&&!0===a.showAlert&&moqui.notifyNotification(a,moqui.notifyGrowl)};this.registerListener=function(a,b){this.webSocket||this.initWebSocket();b||(b=this.displayNotify);var d=this.topicListeners[a];
d||(d=[],this.topicListeners[a]=d,this.webSocket.readyState===WebSocket.OPEN&&this.webSocket.send("subscribe:"+a));0>d.indexOf(b)&&d.push(b)}},LruMap:function(a){this.limit=a;this.valueMap={};this.lruList=[];this.put=function(a,b){var d=this.lruList,e=this.valueMap;e[a]=b;for(this._keyUsed(a);d.length>this.limit;){var f=d.pop();e[f]=null}};this.get=function(a){var b=this.valueMap[a];b&&this._keyUsed(a);return b};this.containsKey=function(a){return!!this.valueMap[a]};this._keyUsed=function(a){for(var b=
this.lruList,d=-1,e=0;e<b.length;e++)if(b[e]===a){d=e;break}0<=d&&b.splice(d,1);b.unshift(a)}}};
$.fn.select2&&($.fn.select2.defaults.set("theme","bootstrap"),$.fn.select2.defaults.set("minimumResultsForSearch","10"),$.fn.select2.defaults.set("dropdownAutoWidth",!0),$.fn.select2.amd.require(["select2/selection/search"],function(a){var c=a.prototype.searchRemoveChoice;a.prototype.searchRemoveChoice=function(){c.apply(this,arguments);this.$search.val("")}}),$.fn.select2.defaults.set("selectOnClose",!0),$(function(){$(".select2-hidden-accessible").on("select2:select",function(a){$(this).valid()})}),
$.fn.modal&&($.fn.modal.Constructor.prototype.enforceFocus=function(){}));
$.validator&&($.validator.setDefaults({errorPlacement:function(a,c){c.parent(".twitter-typeahead").length?a.insertAfter(c.parent()):c.parent(".input-group").length?a.insertAfter(c.parent()):c.hasClass("select2-hidden-accessible")?a.insertAfter(c.next("span")):a.insertAfter(c)}}),$.validator.prototype.errorsFor=function(a){a=this.escapeCssMeta(this.idOrName(a));var c="label[for\x3d'"+a+"'], label[for\x3d'"+a+"'] *";"label"!==this.settings.errorElement&&(c=c+", #"+a+"-error");return this.errors().filter(c)},
$.validator.prototype.errors=function(){var a=this.settings.errorClass.split(" ").join(".");return this.errorContext.is&&this.errorContext.is("form")?$(this.currentForm.elements).parents().parents().find(this.settings.errorElement+"."+a):$(this.settings.errorElement+"."+a,this.errorContext)},$.validator.prototype.elements=function(){var a=this,c={};return $(this.currentForm.elements).filter(":input, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var b=
this.name||$(this).attr("name");!b&&window.console&&console.error("%o has no name assigned",this);this.hasAttribute("contenteditable")&&(this.form=$(this).closest("form")[0],this.name=b);return b in c||!a.objectLength($(this).rules())?!1:c[b]=!0})},$.validator.prototype.init=function(){function a(a){!this.form&&this.hasAttribute("contenteditable")&&(this.form=$(this).closest("form")[0],this.name=$(this).attr("name"));var b=$.data(this.form,"validator"),c="on"+a.type.replace(/^validate/,""),d=b.settings;
d[c]&&!$(this).is(d.ignore)&&d[c].call(b,this,a)}this.labelContainer=$(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm);this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var c=this.groups={},b;$.each(this.settings.groups,function(a,b){"string"===typeof b&&(b=b.split(/\s/));$.each(b,function(b,
d){c[d]=a})});b=this.settings.rules;$.each(b,function(a,c){b[a]=$.validator.normalizeRule(c)});var d=$(this.currentForm.elements).filter(":input, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore);d.on("focusin.validate focusout.validate keyup.validate",a);d.on("click.validate","select, option, [type\x3d'radio'], [type\x3d'checkbox']",a)});
window.Inputmask&&Inputmask.extendAliases({"yyyy-mm-dd hh:mm":{mask:"y-1-2 h:s",placeholder:"yyyy-mm-dd hh:mm",alias:"datetime",separator:"-",leapday:"-02-29",regex:{val2pre:function(a){a=Inputmask.escapeRegex.call(this,a);return new RegExp("((0[13-9]|1[012])"+a+"[0-3])|(02"+a+"[0-2])")},val2:function(a){a=Inputmask.escapeRegex.call(this,a);return new RegExp("((0[1-9]|1[012])"+a+"(0[1-9]|[12][0-9]))|((0[13-9]|1[012])"+a+"30)|((0[13578]|1[02])"+a+"31)")},val1pre:/[01]/,val1:/0[1-9]|1[012]/},onKeyDown:function(a,
c,b,d){}}});